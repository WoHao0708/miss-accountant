<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.w3.org/1999/xhtml">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>記帳本</title>
    <link rel="stylesheet" type="text/css" href="/static/css/root.css">
</head>
<body>
<div class="login-form">
    <form method="post">
        <input type="hidden" id="userId" name="userId" th:value="${userId}">
        <input type="hidden" id="groupId" name="groupId" th:value="${groupId}">
        <div class="form-area">
            <div class="group">
                <label>
                    <input type="checkbox" class="select-all"/>
                    <span>All</span>
                </label>
                <label th:each="account:${accounts}">
                    <input type="checkbox" name="userIds" th:value="${account.userId}"/>
                    <span th:text="${account.name}"></span>
                </label>
            </div>
            <div class="group">
                <input type="number" pattern="[0-9]*" class="form-control" placeholder="每人金額" id="amount" name="amount"
                       required/>
                <i class="fa fa-dollar"></i>
            </div>
            <div class="group">
                <input type="text" class="form-control" placeholder="備註" id="note" name="note"/>
                <i class="fa fa-pencil-square-o"></i>
            </div>
            <button type="button" class="btn btn-default btn-block submit"><p style="padding-top: 7px">送出</p></button>
        </div>
    </form>
</div>
<script src="/static/js/jquery.min.js"></script>
<script>

    function setButtonText() {
        $("p").text("送出");
        $("p").show(1);
    }

    $(".submit").click(function () {
        $("form");
        var form = $("form");
        $.ajax({
            url: "/debt/add",
            type: "POST",
            data: form.serialize(),
            dataType: "json",
            error: function (err) {
                console.log(err);
            },
            success: function (result) {
                $("#note").val("");
                $("#amount").val("");
                $("input[type='checkbox']").prop("checked", false);
                $("p").text(result.message);
                $("p").fadeOut(2000);
                setTimeout(setButtonText, 2000);
            }
        });
    });

    $(".select-all").click(function () {
        if ($(".select-all").prop("checked")) $("input[type='checkbox']").prop("checked", true);
        else $("input[type='checkbox']").prop("checked", false);
    });
</script>
</body>
</html>
